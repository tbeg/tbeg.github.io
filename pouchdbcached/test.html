<!DOCTYPE html>
<html>
<head>
	<title>Leaflet PouchDB Tiles example</title>
	<meta charset="utf-8" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="bower_components/leaflet/dist/leaflet.css" />
</head>
<body>
	<div id="map" style="width: 600px; height: 400px"></div>

	<script src="bower_components/leaflet/dist/leaflet-src.js"></script>
	<script src="bower_components/pouchdb/dist/pouchdb.js"></script>
	<script src="L.TileLayer.PouchDBCached.js"></script>
	<script>

// 		var map = L.map('map').setView([63.41784,10.40359], 5);
		var map = L.map('map').setView([40,-100], 4);

		var layer = L.tileLayer.pouchDBCached('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
				'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
				'Imagery © <a href="http://mapbox.com">Mapbox</a>',
			id: 'examples.map-i875mjb7'
		});

		// Listen to db changes and spam the console
		var changes = layer.db.changes({
			since: 'now',
			live: true
		}).on('change', function(change) { console.log(change); });

		layer.addTo(map);


		var wmsLayer = L.tileLayer.wms.pouchDBCached("http://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi", {
			layers: 'nexrad-n0r-900913',
			format: 'image/png',
			transparent: true,
			attribution: "Weather data © 2012 IEM Nexrad",

			maxAge: 30 * 1000	// 30 seconds
		});

		wmsLayer.addTo(map);

	</script>
</body>
</html>
